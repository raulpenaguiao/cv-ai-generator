# CV Creator Browser — System Description

CV Creator Browser is a Flask-based web application that enables users to produce tailored, professional CVs as PDF documents. At its core, the system manages a per-user data model stored in SQLite — covering personal profile information, chronological experiences (categorised as work, education, or hobby), and project entries — and uses that data as the source of truth for all downstream processing. The database layer uses raw parameterised SQL queries throughout, with no ORM, keeping the query surface minimal and explicit.

User authentication is handled through Flask-Login backed by bcrypt password hashing. Rather than asking users to choose a password on registration, the server generates a cryptographically random one and returns it once. Password reset is supported via single-use, SHA-256-hashed tokens with a one-hour expiry, delivered by SMTP. Each user can store an OpenAI API key in their account; this key is never held in plaintext — it is encrypted at rest using Fernet symmetric encryption, with the encryption key derived from the application's `SECRET_KEY` via HKDF-SHA256, and is decrypted only in memory at the moment an AI call is made.

The AI layer integrates with the OpenAI API (model `gpt-4o-mini`) through two distinct service functions. The first, job analysis, accepts a raw job description and instructs the model — acting as a career advisor — to extract relevant keywords, focus areas, and alignment scores against the user's existing profile and experience data; the result is stored as structured JSON. The second, blurb generation, uses an active job analysis to produce candidate sentences for each configurable field of the selected CV template; the model is given explicit constraints (character limits, sentence counts) drawn from the template's configuration file. Temperature is kept low (0.3) for analysis tasks and higher (0.7) for generative ones.

CV output is produced by a LaTeX compilation pipeline. Jinja2 renders a `.tex` source file from the selected template, using non-standard delimiters (`\VAR{}` and `\BLOCK{}`) to avoid conflicts with LaTeX brace syntax. All user-supplied text is passed through a sanitisation function that escapes every LaTeX-sensitive character before rendering. The rendered source is written to an isolated temporary directory, `pdflatex` is invoked twice (to resolve internal references) with `--no-shell-escape` and a 30-second timeout, and the resulting PDF is moved to a per-user output directory. Both the compiled PDF and the raw `.tex` source are available for download.

The REST API is organised into ten Flask Blueprints covering authentication, profile management, photo uploads, experiences, projects, job analysis, blurb lifecycle, CV compilation, settings, and data import/export. All state-changing endpoints require a CSRF token. File uploads are validated against an extension whitelist and checked against their actual MIME type using `python-magic`, capped at 5 MB, and stored outside the web root with a UUID-prefixed filename. Auth endpoints are rate-limited via Flask-Limiter. A full data export endpoint serialises the user's content to a versioned JSON snapshot (excluding the encrypted API key), and a corresponding import endpoint can restore it, replacing existing records.
